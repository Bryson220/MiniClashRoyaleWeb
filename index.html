<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Clash-lite Arena</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
html,body {height:100%; margin:0; font-family: Arial, Helvetica, sans-serif; background:#9aa0a6;}
#gameWrap { display:flex; align-items:center; justify-content:center; height:100vh; }
canvas { background: linear-gradient(#e6f7ff, #d9f0ff); display:block; border-radius:10px; box-shadow:0 6px 20px rgba(0,0,0,0.25);}
#ui {position:absolute; left:50%; transform:translateX(-50%); bottom:24px; width:760px; max-width:92vw; display:flex; align-items:center; justify-content:space-between; gap:12px; pointer-events:none;}
.card-slot {width:180px; height:72px; background:linear-gradient(#ffffff,#e9eef6); border-radius:12px; box-shadow:0 3px 8px rgba(0,0,0,0.15); display:flex; align-items:center; justify-content:flex-start; gap:12px; padding:12px; pointer-events:auto; cursor:pointer; transition:transform .12s ease;}
.card-slot.selected {outline:3px solid #66b3ff; transform:translateY(-6px);}
.card-thumb { width:48px; height:48px; border-radius:6px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:white; }
.card-info { display:flex; flex-direction:column; font-size:13px; color:#2b2b2b; }
.card-cost { font-weight:700; }
.disabled { opacity:0.45; pointer-events:none; filter:grayscale(60%); }
#elixir { width:220px; background:rgba(0,0,0,0.06); border-radius:12px; padding:8px; display:flex; flex-direction:column; gap:6px; pointer-events:auto; }
#elixir .bar { height:14px; background:linear-gradient(#2eb8ff,#006fbd); border-radius:8px; width:0%; transition:width .25s linear; }
#info { position:absolute; left:18px; top:18px; background:rgba(255,255,255,0.85); padding:10px 12px; border-radius:10px; font-size:13px; }
</style>
</head>
<body>
<div id="gameWrap">
  <canvas id="c" width="540" height="960"></canvas>
</div>
<div id="ui">
  <div id="cards" style="display:flex;gap:12px;"></div>
  <div id="elixir">
    <div style="font-size:13px; color:#073b5c; font-weight:700; text-align:center;">Elixir <span id="elixirVal">0</span>/10</div>
    <div style="background:rgba(0,0,0,0.08); border-radius:8px; height:16px;">
      <div class="bar" id="elixirBar"></div>
    </div>
  </div>
</div>
<div id="info">Click a card then click the field to place it. Enemy spawns automatically (limited). Units attack enemies, then towers.</div>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const arena = { x:40, y:40, w:460, h:880 };

const water = { y:arena.y + arena.h/2 - 80, h:160 };
const bridgeW = 120;

// Towers
const towerW = 48, towerH = 64;
const towers = [
  {id:'enemy-left',team:'enemy',x:arena.x + 60, y:arena.y+40, w:towerW,h:towerH, hp:300},
  {id:'enemy-right',team:'enemy',x:arena.x + arena.w - 60 - towerW, y:arena.y+40, w:towerW,h:towerH, hp:300},
  {id:'player-left',team:'player',x:arena.x + 60, y:arena.y + arena.h - 40 - towerH, w:towerW,h:towerH, hp:300},
  {id:'player-right',team:'player',x:arena.x + arena.w - 60 - towerW, y:arena.y + arena.h - 40 - towerH, w:towerW,h:towerH, hp:300}
];

// Units
const units = [];
let elixir = 0, lastElixirTick = performance.now();
const elMax = 10, elRegenMs = 2800;

const cardDefs = [
  { id:'knight', name:'Knight', cost:3, hp:100, dmg:12, size:18, speed:55 },
  { id:'archer', name:'Archer', cost:2, hp:60, dmg:10, size:14, speed:95 },
  { id:'giant', name:'Giant', cost:5, hp:200, dmg:18, size:26, speed:42 }
];
const deck = [...cardDefs];
let selectedCardIndex = null;

// Mouse
const mousePos = { x:0, y:0, insideArena:false };
canvas.addEventListener('mousemove',(e)=>{ const r=canvas.getBoundingClientRect(); mousePos.x=(e.clientX-r.left)*(canvas.width/r.width); mousePos.y=(e.clientY-r.top)*(canvas.height/r.height); mousePos.insideArena = mousePos.x>=arena.x && mousePos.x<=arena.x+arena.w && mousePos.y>=arena.y && mousePos.y<=arena.y+arena.h; });
canvas.addEventListener('mouseleave',()=>{mousePos.insideArena=false;});

canvas.addEventListener('click',(e)=>{
  if(selectedCardIndex===null || !mousePos.insideArena) return;
  const card = deck[selectedCardIndex];
  if(elixir<card.cost){ selectedCardIndex=null; updateCardUI(); return; }
  const lane = mousePos.x<arena.x+arena.w/2?'left':'right';
  const unit = {team:'player', x:mousePos.x, y:mousePos.y, size:card.size, hp:card.hp, dmg:card.dmg, speed:card.speed, lane};
  units.push(unit);
  elixir -= card.cost; updateElixirUI(); updateCardUI(); selectedCardIndex=null; updateCardUI();
});

// Draw arena
function drawArena() {
  ctx.fillStyle = '#bfbfc6'; ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = '#cfeccf'; ctx.fillRect(arena.x,arena.y,arena.w,arena.h);
  ctx.fillStyle = '#7cc6ff'; ctx.fillRect(arena.x,water.y,arena.w,water.h);
  // bridges
  ctx.fillStyle = '#b48a4f';
  ctx.fillRect(arena.x+60,water.y,bridgeW,water.h);
  ctx.fillRect(arena.x+arena.w-60-bridgeW,water.y,bridgeW,water.h);
}

// Draw towers
function drawTowers() {
  for(let t of towers){
    ctx.fillStyle = t.team==='player'?'#8b5a2b':'#6b2b2b';
    ctx.fillRect(t.x,t.y,t.w,t.h);
    const pct=t.hp/300; ctx.fillStyle='#4caf50'; ctx.fillRect(t.x,t.y-6,t.w*pct,4);
  }
}

// Draw units
function drawUnits() {
  for(let u of units){
    ctx.beginPath(); ctx.fillStyle=u.team==='player'?'#2b9f49':'#d64545';
    ctx.arc(u.x,u.y,u.size,0,Math.PI*2); ctx.fill();
  }
}

function gameLoop(now){
  // Elixir
  if(now-lastElixirTick>=elRegenMs){
    const points=Math.floor((now-lastElixirTick)/elRegenMs);
    elixir=Math.min(elMax,elixir+points);
    lastElixirTick+=points*elRegenMs;
    updateElixirUI();
  }

  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawArena(); drawTowers(); drawUnits();
  requestAnimationFrame(gameLoop);
}

function updateElixirUI(){
  document.getElementById('elixirVal').textContent = elixir;
  document.getElementById('elixirBar').style.width = (elixir/elMax*100)+'%';
}

// Card UI
const cardsDiv = document.getElementById('cards');
deck.forEach((c,i)=>{
  const slot = document.createElement('div'); slot.className='card-slot'; slot.dataset.index=i;
  slot.innerHTML=`<div class="card-thumb" style="background:${i===0?'#4caf50':i===1?'#2196f3':'#795548'}">${c.name[0]}</div>
  <div class="card-info"><div style="font-weight:700">${c.name}</div><div class="card-cost">Cost: <span>${c.cost}</span></div></div>`;
  slot.addEventListener('click',()=>{ selectedCardIndex = selectedCardIndex===i?null:i; updateCardUI(); });
  cardsDiv.appendChild(slot);
});

function updateCardUI(){
  Array.from(cardsDiv.children).forEach((el,i)=>{
    const cost=deck[i].cost; el.classList.toggle('disabled',elixir<cost);
    el.classList.toggle('selected',selectedCardIndex===i);
  });
}

requestAnimationFrame(gameLoop);
</script>
</body>
</html>
